#include <err.h>
#include <stdio.h>
#include <errno.h>
#include <signal.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <linux/seccomp.h>
#include <inttypes.h>
#include <sys/mman.h>
#include <sys/stat.h>
#include <sys/user.h>
#include <sys/wait.h>
#include <sys/prctl.h>
#include <sys/syscall.h>


int main(void)
{
    unsigned long mmap_min_addr;
    int prot, flags;
    char *p;
    char *bin_path = "./flag";

	char * const argv[] = {"./flag"};
	char * const envp[] = {NULL};

	mmap_min_addr = 0x10000;

    prot = PROT_READ | PROT_WRITE | PROT_EXEC;
    flags = MAP_GROWSDOWN | MAP_ANONYMOUS | MAP_FIXED;
    p = mmap((void *)mmap_min_addr + PAGE_SIZE, PAGE_SIZE, prot, flags, -1, 0);

    strcpy(p, bin_path);
    execve(p, argv, envp);

    exit(0);
}
